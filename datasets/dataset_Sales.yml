unique_name: dataset_Sales
object_type: dataset
label: Sales
columns:
  - name: PROJECT_ID
    data_type: double
  - name: TopTaskID
    data_type: string
  - name: SalesMonth
    data_type: datetime
  - name: SalesAmount
    data_type: double
  - name: countrows1
    data_type: int
    sql: '1'
connection_id: SQL42
sql: >-
  SELECT Project_Sales.PROJECT_ID, ISNULL(Project_Sales.TOP_TASK_ID,
  Project_Sales.PROJECT_ID * - 1) AS TopTaskID,
  DATEFROMPARTS(YEAR(Project_Sales.SALES_DATE),
  MONTH(Project_Sales.SALES_DATE),1) AS SalesMonth, Project_Sales.SALES_AMOUNT
  AS SalesAmount FROM AnalyticsSource.dbo.Project_Sales INNER JOIN /* direct
  projects with to-date actuals costs or non-converted approved cost budgets,
  primary cost forecasts, or primary revenue forecasts with baselined dates on
  or after 7/1/2013 */ (SELECT DISTINCT FinancialPlanVersions.PROJECT_ID FROM
  AnalyticsSource.dbo.FinancialPlanVersions INNER JOIN
  EnterpriseDataStore.dbo.Projects ON FinancialPlanVersions.PROJECT_ID =
  Projects.Project_ID AND Projects.DirectFlag = 'Y' WHERE
  (FinancialPlanVersions.FIN_PLAN_TYPE_ID IN (10040, 10060, 10062)) /* Approved
  Cost Budget, Primary Cost Forecast, Primary Revenue Forecast */ AND
  (FinancialPlanVersions.VERSION_NAME <> 'CONVERTED VERSION') AND
  (FinancialPlanVersions.BASELINED_DATE >= try_convert(date, '2013-07-01')) OR
  (FinancialPlanVersions.FIN_PLAN_TYPE_ID = 156596) /* To-Date Actuals Cost */
  union all SELECT DISTINCT FinancialPlanVersions.PROJECT_ID FROM
  AnalyticsSource.east.FinancialPlanVersions INNER JOIN
  EnterpriseDataStore.east.Projects ON FinancialPlanVersions.PROJECT_ID =
  Projects.Project_ID AND Projects.DirectFlag = 'Y' WHERE
  (FinancialPlanVersions.FIN_PLAN_TYPE_ID IN (10040, 10060, 10062)) /* Approved
  Cost Budget, Primary Cost Forecast, Primary Revenue Forecast */ AND
  (FinancialPlanVersions.VERSION_NAME <> 'CONVERTED VERSION') AND
  (FinancialPlanVersions.BASELINED_DATE >= try_convert(date, '2013-07-01')) OR
  (FinancialPlanVersions.FIN_PLAN_TYPE_ID = 156596) /* To-Date Actuals Cost */ )
  AS ProjectList ON Project_Sales.PROJECT_ID = ProjectList.PROJECT_ID WHERE
  Project_Sales.SALES_AMOUNT <> 0 AND Project_Sales.PROJECT_ID <> 1427177
