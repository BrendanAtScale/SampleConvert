unique_name: dataset_Historic-PSR
object_type: dataset
label: Historic-PSR
columns:
  - name: PROJECT_ID
    data_type: long
  - name: PSR_START_DATE
    data_type: datetime
  - name: PROJECT_STATUS_CODE
    data_type: string
  - name: BILLING_LEVEL
    data_type: string
  - name: TOTAL_REVENUE_ITD
    data_type: double
  - name: TOTAL_LABOR_HOURS_ITD
    data_type: double
  - name: TOTAL_COST_ITD
    data_type: double
  - name: FORECAST_REV_TOTAL
    data_type: double
  - name: FORECAST_HOURS_TOTAL
    data_type: double
  - name: FORECAST_LABOR
    data_type: double
  - name: FORECAST_BURDEN
    data_type: double
  - name: FORECAST_COST_TOTAL
    data_type: double
  - name: FORECAST_CONTINGENCY
    data_type: double
  - name: FORECAST_INT_CONTINGENCY
    data_type: double
  - name: FORECAST_CONTINGENCY_ALLOC
    data_type: double
  - name: FORECAST_WARRANTY
    data_type: double
  - name: FORECAST_INT_WARRANTY
    data_type: double
  - name: FORECAST_WARRANTY_ALLOC
    data_type: double
  - name: FORECAST_COND_CONTINGENCY
    data_type: double
  - name: LABOR_OVERRUN
    data_type: double
  - name: NONLABOR_OVERRUN
    data_type: double
  - name: ETC_REVENUE
    data_type: double
  - name: ETC_COST_TOTAL
    data_type: double
  - name: ABS Value
    data_type: double
    sql: >-
      null
      /*abs('Historic-PSR'[TOTAL_REVENUE_ITD])+abs('Historic-PSR'[TOTAL_LABOR_HOURS_ITD])+abs('Historic-PSR'[TOTAL_COST_ITD])+abs('Historic-PSR'[FORECAST_REV_TOTAL]+abs('Historic-PSR'[FORECAST_HOURS_TOTAL])+abs('Historic-PSR'[FORECAST_COST_TOTAL]))
      TODO: Replace with valid SQL*/
  - name: FORECAST_CWK_LABOR
    data_type: double
  - name: FORECAST_EXPENSE
    data_type: double
  - name: ETC_LABOR
    data_type: double
  - name: ETC_BURDEN
    data_type: double
  - name: ETC_CWK_LABOR
    data_type: double
  - name: ETC_EXPENSE
    data_type: double
  - name: Historic-EAC-Hours-EO
    data_type: double
    sql: >-
      null /*IF('Historic-PSR'[CurrentForecastMonth],
      'Historic-PSR'[ITD-Hours-EO] + 'Historic-PSR'[Historic-ETC-Hours-EO],
      'Historic-PSR'[FORECAST_HOURS_TOTAL] * 'Historic-PSR'[EOForecastPercent])
      TODO: Replace with valid SQL*/
  - name: Historic-EAC-Hours-Craft
    data_type: double
    sql: >-
      null /*IF('Historic-PSR'[CurrentForecastMonth],,
      'Historic-PSR'[ITD-Hours-Craft] + ('Historic-PSR'[FORECAST_HOURS_TOTAL] -
      'Historic-PSR'[TOTAL_LABOR_HOURS_ITD]) *
      'Historic-PSR'[CraftForecastPercent],,
      'Historic-PSR'[FORECAST_HOURS_TOTAL] *
      'Historic-PSR'[CraftForecastPercent]) TODO: Replace with valid SQL*/
  - name: Historic-ETC-Hours-EO
    data_type: double
    sql: >-
      null /*DIVIDE(,('Historic-PSR'[FORECAST_HOURS_TOTAL] -
      'Historic-PSR'[TOTAL_LABOR_HOURS_ITD]) *
      'Historic-PSR'[EOForecastPercent],, 'Historic-PSR'[EOForecastPercent] <>
      0) TODO: Replace with valid SQL*/
  - name: Historic-ETC-Hours-Craft
    data_type: double
    sql: >-
      null /*DIVIDE(,('Historic-PSR'[FORECAST_HOURS_TOTAL] -
      'Historic-PSR'[TOTAL_LABOR_HOURS_ITD]) *
      'Historic-PSR'[CraftForecastPercent],,
      'Historic-PSR'[CraftForecastPercent] <> 0) TODO: Replace with valid SQL*/
  - name: ITD-Hours-EO
    data_type: double
    sql: >-
      null /*CALCULATE([ITD Actual Hours-EO], FILTER(ALL(Dates), Dates[Date] =
      'Historic-PSR'[PSR_START_DATE]), FILTER(ALL('Tasks'), 'Tasks'[TopTaskID] =
      'Historic-PSR'[TaskID])) TODO: Replace with valid SQL*/
  - name: ITD-Hours
    data_type: double
    sql: >-
      null /*CALCULATE([ITD Actual Hours], FILTER(ALL(Dates), Dates[Date] =
      'Historic-PSR'[PSR_START_DATE]), FILTER(ALL(Tasks), 'Tasks'[TopTaskID] =
      'Historic-PSR'[TaskID])) TODO: Replace with valid SQL*/
  - name: ITD-Hours-Craft
    data_type: double
    sql: >-
      null /*CALCULATE([ITD Actual Hours-Craft-Labor], FILTER(ALL(Dates),
      Dates[Date] = 'Historic-PSR'[PSR_START_DATE]), FILTER(ALL('Tasks'),
      'Tasks'[TopTaskID] = 'Historic-PSR'[TaskID])) TODO: Replace with valid
      SQL*/
  - name: CraftForecastPercent
    data_type: double
    sql: >-
      null /* var CurrentMonthForecast =,DIVIDE(,DIVIDE(,ROUND(CALCULATE([.ETC
      Hours (backlog)], FILTER(Resources, Resources[Resource Category] = "Craft
      Labor"), ALL(Dates), FILTER(ALL(Tasks), Tasks[TopTaskID] =
      'Historic-PSR'[TaskID])), 4),+
      if(NOT(ISBLANK('Historic-PSR'[ITD-Hours-Craft])), 0) /* force craft
      percent for the current month to have a value using current ETC breakdown
      if there are any craft hours */,, ROUND(CALCULATE([.ETC Hours (backlog)],
      ALL(Dates), FILTER(ALL(Tasks), Tasks[TopTaskID] =
      'Historic-PSR'[TaskID])), 4),),,
      'Historic-PSR'[CurrentForecastMonth],),,var
      ITDActuals=,DIVIDE('Historic-PSR'[ITD-Hours-Craft]+0,
      'Historic-PSR'[ITD-Hours]),,return
      ,switch(TRUE(),,NOT(ISBLANK(CurrentMonthForecast)),
      CurrentMonthForecast,,NOT(ISBLANK(ITDActuals)), ITDActuals,, 0,) TODO:
      Replace with valid SQL*/
  - name: EOForecastPercent
    data_type: double
    sql: >-
      null /* var CurrentMonthForecast =,DIVIDE(,DIVIDE(,ROUND(CALCULATE([.ETC
      Hours (backlog)], FILTER(Resources, Resources[Resource Category] =
      "Employee Labor"), ALL(Dates), FILTER(ALL(Tasks), Tasks[TopTaskID] =
      'Historic-PSR'[TaskID])), 4),, ROUND(CALCULATE([.ETC Hours (backlog)],
      ALL(Dates), FILTER(ALL(Tasks), Tasks[TopTaskID] =
      'Historic-PSR'[TaskID])), 4),),,
      'Historic-PSR'[CurrentForecastMonth],),,var
      ITDActuals=,DIVIDE('Historic-PSR'[ITD-Hours-EO]+0,
      'Historic-PSR'[ITD-Hours]),,return,switch(TRUE(),,NOT(ISBLANK(CurrentMonthForecast)),
      CurrentMonthForecast,,NOT(ISBLANK(ITDActuals)), ITDActuals,, 1,) TODO:
      Replace with valid SQL*/
  - name: CurrentForecastMonth
    data_type: boolean
    sql: >-
      null /*DATE(YEAR(FIRSTNONBLANK(ModelSettings[ForecastHistoryCutoffDate],
      "")), MONTH(FIRSTNONBLANK(ModelSettings[ForecastHistoryCutoffDate], "")),
      1) = 'Historic-PSR'[PSR_START_DATE] TODO: Replace with valid SQL*/
  - name: OverheadLugRate-EO
    data_type: double
    sql: >-
      null /*LOOKUPVALUE(,OverheadLugs[Lug], ,OverheadLugs[Operating Unit],
      RELATED(Projects[Operating Unit]), ,OverheadLugs[Resource Type], "EO",),+
      0,  TODO: Replace with valid SQL*/
  - name: OverheadLugRate-CWK
    data_type: double
    sql: >-
      null /*LOOKUPVALUE(,OverheadLugs[Lug], ,OverheadLugs[Operating Unit],
      RELATED(Projects[Operating Unit]), ,OverheadLugs[Resource Type], "CWK",),+
      0,  TODO: Replace with valid SQL*/
  - name: OverheadLugRate-Craft
    data_type: double
    sql: >-
      null /*LOOKUPVALUE(,OverheadLugs[Lug], ,OverheadLugs[Operating Unit],
      RELATED(Projects[Operating Unit]), ,OverheadLugs[Resource Type],
      "CRAFT",),+ 0, TODO: Replace with valid SQL*/
  - name: ITD-Hours-CWK
    data_type: double
    sql: >-
      null /*CALCULATE([ITD Actual Hours-CWK], FILTER(ALL(Dates), Dates[Date] =
      'Historic-PSR'[PSR_START_DATE]), FILTER(ALL('Tasks'), 'Tasks'[TopTaskID] =
      'Historic-PSR'[TaskID])) TODO: Replace with valid SQL*/
  - name: CWKForecastPercent
    data_type: double
    sql: >-
      null /* var CurrentMonthForecast =,DIVIDE(,DIVIDE(,ROUND(CALCULATE([.ETC
      Hours (backlog)], FILTER(Resources, Resources[Resource Category] =
      "Contract Labor"), ALL(Dates), FILTER(ALL(Tasks), Tasks[TopTaskID] =
      'Historic-PSR'[TaskID])), 4),, ROUND(CALCULATE([.ETC Hours (backlog)],
      ALL(Dates), FILTER(ALL(Tasks), Tasks[TopTaskID] =
      'Historic-PSR'[TaskID])), 4),+
      if(NOT(ISBLANK('Historic-PSR'[ITD-Hours-CWK])), 0) /* force craft percent
      for the current month to have a value using current ETC breakdown if there
      are any craft hours */,),, 'Historic-PSR'[CurrentForecastMonth],),,var
      ITDActuals=,DIVIDE('Historic-PSR'[ITD-Hours-CWK]+0,
      'Historic-PSR'[ITD-Hours]),,return,switch(TRUE(),,NOT(ISBLANK(CurrentMonthForecast)),
      CurrentMonthForecast,,NOT(ISBLANK(ITDActuals)), ITDActuals,, 0,) TODO:
      Replace with valid SQL*/
  - name: Historic-ETC-Hours-CWK
    data_type: double
    sql: >-
      null /*DIVIDE(,('Historic-PSR'[FORECAST_HOURS_TOTAL] -
      'Historic-PSR'[TOTAL_LABOR_HOURS_ITD]) *
      'Historic-PSR'[CWKForecastPercent],, 'Historic-PSR'[CWKForecastPercent] <>
      0) TODO: Replace with valid SQL*/
  - name: Historic-EAC-Hours-CWK
    data_type: double
    sql: >-
      null /*IF('Historic-PSR'[CurrentForecastMonth],
      'Historic-PSR'[ITD-Hours-CWK] + 'Historic-PSR'[Historic-ETC-Hours-CWK],
      'Historic-PSR'[FORECAST_HOURS_TOTAL] * 'Historic-PSR'[CWKForecastPercent])
      TODO: Replace with valid SQL*/
  - name: TaskID
    data_type: string
  - name: CraftForecastRawCostPercent
    data_type: double
    sql: >-
      null /* var CurrentMonthForecast =,DIVIDE(,DIVIDE(,ROUND(CALCULATE([.ETC
      Cost-Labor-Craft-Labor-Raw], ALL(Dates), FILTER(ALL(Tasks),
      Tasks[TopTaskID] = 'Historic-PSR'[TaskID])), 4),+
      if(NOT(ISBLANK('Historic-PSR'[ITD-Cost-Craft-Raw])), 0) /* force craft
      percent for the current month to have a value using current ETC breakdown
      if there are any craft hours */,, ROUND(CALCULATE([.ETC Cost],
      FILTER(Resources, SEARCH("Raw", Resources[Labor Detail],,-1) > 0),
      ALL(Dates), FILTER(ALL(Tasks), Tasks[TopTaskID] =
      'Historic-PSR'[TaskID])), 4),),,
      'Historic-PSR'[CurrentForecastMonth],),,var
      ITDActuals=,DIVIDE('Historic-PSR'[ITD-Cost-Craft-Raw],
      'Historic-PSR'[ITD-Cost-Labor-Raw]),,return
      ,switch(TRUE(),,NOT(ISBLANK(CurrentMonthForecast)),
      CurrentMonthForecast,,NOT(ISBLANK(ITDActuals)), ITDActuals,, 0,) TODO:
      Replace with valid SQL*/
  - name: ITD-Cost-Craft-Raw
    data_type: double
    sql: >-
      null /*CALCULATE([ITD Actual Cost-Labor-Craft-Labor-Raw],
      FILTER(ALL(Dates), Dates[Date] = 'Historic-PSR'[PSR_START_DATE]),
      FILTER(ALL('Tasks'), 'Tasks'[TopTaskID] = 'Historic-PSR'[TaskID])), TODO:
      Replace with valid SQL*/
  - name: ITD-Cost-Labor-Raw
    data_type: double
    sql: >-
      null /*CALCULATE([ITD Actual Cost-Labor-Craft-Labor-Raw],
      FILTER(ALL(Dates), Dates[Date] = 'Historic-PSR'[PSR_START_DATE]),
      FILTER(ALL(Tasks), 'Tasks'[TopTaskID] = 'Historic-PSR'[TaskID])),+
      CALCULATE([ITD Actual Cost-Labor-EO-Raw], FILTER(ALL(Dates), Dates[Date] =
      'Historic-PSR'[PSR_START_DATE]), FILTER(ALL(Tasks), 'Tasks'[TopTaskID] =
      'Historic-PSR'[TaskID])) TODO: Replace with valid SQL*/
  - name: EOForecastRawCostPercent
    data_type: double
    sql: >-
      null /* var CurrentMonthForecast =,DIVIDE(,DIVIDE(,ROUND(CALCULATE([.ETC
      Cost-Labor-EO-Raw], ALL(Dates), FILTER(ALL(Tasks), Tasks[TopTaskID] =
      'Historic-PSR'[TaskID])), 4),+
      if(NOT(ISBLANK('Historic-PSR'[ITD-Cost-EO-Raw])), 0) /* force EO percent
      for the current month to have a value using current ETC breakdown if there
      are any EO hours */,, ROUND(CALCULATE([.ETC Cost], FILTER(Resources,
      SEARCH("Raw", Resources[Labor Detail],,-1) > 0), ALL(Dates),
      FILTER(ALL(Tasks), Tasks[TopTaskID] = 'Historic-PSR'[TaskID])), 4),,),,
      'Historic-PSR'[CurrentForecastMonth],),,var
      ITDActuals=,DIVIDE('Historic-PSR'[ITD-Cost-EO-Raw],
      'Historic-PSR'[ITD-Cost-Labor-Raw]),,return,switch(TRUE(),,NOT(ISBLANK(CurrentMonthForecast)),
      CurrentMonthForecast,,NOT(ISBLANK(ITDActuals)), ITDActuals,, 1,) TODO:
      Replace with valid SQL*/
  - name: ITD-Cost-EO-Raw
    data_type: double
    sql: >-
      null /*CALCULATE([ITD Actual Cost-Labor-EO-Raw], FILTER(ALL(Dates),
      Dates[Date] = 'Historic-PSR'[PSR_START_DATE]), FILTER(ALL('Tasks'),
      'Tasks'[TopTaskID] = 'Historic-PSR'[TaskID])) TODO: Replace with valid
      SQL*/
  - name: Historic-ETC-Cost-EO-Raw
    data_type: double
    sql: >-
      null /*/*('Historic-PSR'[FORECAST_LABOR] -
      'Historic-PSR'[DIRECT_LABOR_ITD]) */,'Historic-PSR'[ETC_LABOR] *
      'Historic-PSR'[EOForecastRawCostPercent] TODO: Replace with valid SQL*/
  - name: DIRECT_LABOR_ITD
    data_type: double
  - name: BURDEN_LABOR_ITD
    data_type: double
  - name: CWK_LABOR_ITD
    data_type: double
  - name: Historic-EAC-Cost-EO-Raw
    data_type: double
    sql: >-
      null /*IF('Historic-PSR'[CurrentForecastMonth],
      'Historic-PSR'[ITD-Cost-EO-Raw] +
      'Historic-PSR'[Historic-ETC-Cost-EO-Raw], 'Historic-PSR'[FORECAST_LABOR] *
      'Historic-PSR'[EOForecastRawCostPercent]) TODO: Replace with valid SQL*/
  - name: Historic-ETC-Cost-Craft-Raw
    data_type: double
    sql: >-
      null /*/*('Historic-PSR'[FORECAST_LABOR] -
      'Historic-PSR'[DIRECT_LABOR_ITD]) */,'Historic-PSR'[ETC_LABOR] *
      'Historic-PSR'[CraftForecastRawCostPercent] TODO: Replace with valid SQL*/
  - name: Historic-EAC-Cost-Craft-Raw
    data_type: double
    sql: >-
      null /*IF('Historic-PSR'[CurrentForecastMonth],
      'Historic-PSR'[ITD-Cost-Craft-Raw] +
      'Historic-PSR'[Historic-ETC-Cost-Craft-Raw],
      'Historic-PSR'[FORECAST_LABOR] *
      'Historic-PSR'[CraftForecastRawCostPercent]) TODO: Replace with valid
      SQL*/
  - name: ITD-Cost-EO-Burden
    data_type: double
    sql: >-
      null /*CALCULATE([ITD Actual Cost-Labor-EO-Burden], FILTER(ALL(Dates),
      Dates[Date] = 'Historic-PSR'[PSR_START_DATE]), FILTER(ALL('Tasks'),
      'Tasks'[TopTaskID] = 'Historic-PSR'[TaskID])) TODO: Replace with valid
      SQL*/
  - name: ITD-Cost-Craft-Burden
    data_type: double
    sql: >-
      null /*CALCULATE([ITD Actual Cost-Labor-Craft-Burden], FILTER(ALL(Dates),
      Dates[Date] = 'Historic-PSR'[PSR_START_DATE]), FILTER(ALL('Tasks'),
      'Tasks'[TopTaskID] = 'Historic-PSR'[TaskID])) TODO: Replace with valid
      SQL*/
  - name: CraftForecastBurdenCostPercent
    data_type: double
    sql: >-
      null /* var CurrentMonthForecast =,DIVIDE(,DIVIDE(,ROUND(CALCULATE([.ETC
      Cost-Labor-Craft-Burden], ALL(Dates), FILTER(ALL(Tasks), Tasks[TopTaskID]
      = 'Historic-PSR'[TaskID])), 4),+
      if(NOT(ISBLANK('Historic-PSR'[ITD-Cost-Craft-Burden])), 0) /* force craft
      percent for the current month to have a value using current ETC breakdown
      if there are any craft hours */,, ROUND(CALCULATE([.ETC Cost],
      FILTER(Resources, SEARCH("Burden", Resources[Labor Detail],,-1) > 0),
      ALL(Dates), FILTER(ALL(Tasks), Tasks[TopTaskID] =
      'Historic-PSR'[TaskID])), 4),),,
      'Historic-PSR'[CurrentForecastMonth],),,var
      ITDActuals=,DIVIDE('Historic-PSR'[ITD-Cost-Craft-Burden],
      'Historic-PSR'[ITD-Cost-Labor-Burden]),,return
      ,switch(TRUE(),,NOT(ISBLANK(CurrentMonthForecast)),
      CurrentMonthForecast,,NOT(ISBLANK(ITDActuals)), ITDActuals,, 0,) TODO:
      Replace with valid SQL*/
  - name: ITD-Cost-Labor-Burden
    data_type: double
    sql: >-
      null /*CALCULATE([ITD Actual Cost-Labor-Craft-Burden], FILTER(ALL(Dates),
      Dates[Date] = 'Historic-PSR'[PSR_START_DATE]), FILTER(ALL(Tasks),
      'Tasks'[TopTaskID] = 'Historic-PSR'[TaskID])),+ CALCULATE([ITD Actual
      Cost-Labor-EO-Burden], FILTER(ALL(Dates), Dates[Date] =
      'Historic-PSR'[PSR_START_DATE]), FILTER(ALL(Tasks), 'Tasks'[TopTaskID] =
      'Historic-PSR'[TaskID])) TODO: Replace with valid SQL*/
  - name: Historic-EAC-Cost-EO-Burden
    data_type: double
    sql: >-
      null /*IF('Historic-PSR'[CurrentForecastMonth],
      'Historic-PSR'[ITD-Cost-EO-Burden] +
      'Historic-PSR'[Historic-ETC-Cost-EO-Burden],
      'Historic-PSR'[FORECAST_BURDEN] *
      'Historic-PSR'[EOForecastBurdenCostPercent]) TODO: Replace with valid
      SQL*/
  - name: Historic-ETC-Cost-EO-Burden
    data_type: double
    sql: >-
      null /*'Historic-PSR'[ETC_BURDEN] *
      'Historic-PSR'[EOForecastBurdenCostPercent] TODO: Replace with valid SQL*/
  - name: EOForecastBurdenCostPercent
    data_type: double
    sql: >-
      null /* var CurrentMonthForecast =,DIVIDE(,DIVIDE(,ROUND(CALCULATE([.ETC
      Cost-Labor-EO-Burden], ALL(Dates), FILTER(ALL(Tasks), Tasks[TopTaskID] =
      'Historic-PSR'[TaskID])), 4),+
      if(NOT(ISBLANK('Historic-PSR'[ITD-Cost-EO-Burden])), 0) /* force EO
      percent for the current month to have a value using current ETC breakdown
      if there are any EO hours */,, ROUND(CALCULATE([.ETC Cost],
      FILTER(Resources, SEARCH("Burden", Resources[Labor Detail],,-1) > 0),
      ALL(Dates), FILTER(ALL(Tasks), Tasks[TopTaskID] =
      'Historic-PSR'[TaskID])), 4),),,
      'Historic-PSR'[CurrentForecastMonth],),,var
      ITDActuals=,DIVIDE('Historic-PSR'[ITD-Cost-EO-Burden],
      'Historic-PSR'[ITD-Cost-Labor-Burden]),,return,switch(TRUE(),,NOT(ISBLANK(CurrentMonthForecast)),
      CurrentMonthForecast,,NOT(ISBLANK(ITDActuals)), ITDActuals,, 1,) TODO:
      Replace with valid SQL*/
  - name: Historic-EAC-Cost-Craft-Burden
    data_type: double
    sql: >-
      null /*IF('Historic-PSR'[CurrentForecastMonth],
      'Historic-PSR'[ITD-Cost-Craft-Burden] +
      'Historic-PSR'[Historic-ETC-Cost-Craft-Burden],
      'Historic-PSR'[FORECAST_BURDEN] *
      'Historic-PSR'[CraftForecastBurdenCostPercent]) TODO: Replace with valid
      SQL*/
  - name: Historic-ETC-Cost-Craft-Burden
    data_type: double
    sql: >-
      null /*'Historic-PSR'[ETC_BURDEN] *
      'Historic-PSR'[CraftForecastBurdenCostPercent] TODO: Replace with valid
      SQL*/
  - name: countrows1
    data_type: int
    sql: '1'
connection_id: SQL42
table: Historic-PSR
