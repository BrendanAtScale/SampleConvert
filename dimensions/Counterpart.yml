unique_name: Counterpart
object_type: dimension
label: Counterpart
type: standard

hierarchies:

  - unique_name: By Counterpart Type
    label: By Counterpart Type
    filter_empty: "yes"

    levels:

      - unique_name: By Counterpart Type Level

        secondary_attributes:

          - unique_name: d_COUNTERPART_TYPE
            label: Counterpart Type
            folder: Attribute
            dataset: VW_COUNTERPART_SCML.dataset
            key_columns:
              - COUNTERPART_TYPE
            name_column: COUNTERPART_TYPE
            sort_column: COUNTERPART_TYPE
            allowed_calcs_for_dma:
              - Lag
              - Range
              - Siblings

      - unique_name: Counterpart Sub Type

        secondary_attributes:

          - unique_name: d_COUNTERPART_SUB_TYPE
            label: Counterpart Sub Type
            folder: Attribute
            dataset: VW_COUNTERPART_SCML.dataset
            key_columns:
              - COUNTERPART_SUB_TYPE
            name_column: COUNTERPART_SUB_TYPE
            sort_column: COUNTERPART_SUB_TYPE
            allowed_calcs_for_dma:
              - Lag
              - Range
              - Siblings

      - unique_name: Counterpart ID

        secondary_attributes:

          - unique_name: d_COUNTERPART_ID
            label: Counterpart ID
            associated_hierarchy: By Counterpart Type
            dataset: VW_COUNTERPART_SCML.dataset
            key_columns:
              - COUNTERPART_ID
            name_column: COUNTERPART_ID
            sort_column: COUNTERPART_ID
            allowed_calcs_for_dma:
              - Lag
              - Range
              - Siblings

      - unique_name: Counterpart Level
        is_hidden: true

        secondary_attributes:

          - unique_name: d_BASE_OWNER_ID
            label: Base Owner ID
            folder: Attribute
            associated_hierarchy: By Counterpart Type
            dataset: VW_COUNTERPART_SCML.dataset
            key_columns:
              - BASE_OWNER_ID
            name_column: BASE_OWNER_ID
            sort_column: BASE_OWNER_ID
            allowed_calcs_for_dma:
              - Lag
              - Range
              - Siblings

  - unique_name: By Counterpart Owner
    label: By Counterpart Owner
    filter_empty: "yes"

    levels:

      - unique_name: By Counterpart Owner Level

        secondary_attributes:

          - unique_name: d_COUNTERPART_OWNER_ID
            label: Owner ID
            folder: Attribute
            dataset: VW_COUNTERPART_SCML.dataset
            key_columns:
              - COUNTERPART_OWNER_ID
            name_column: COUNTERPART_OWNER_ID
            sort_column: COUNTERPART_OWNER_ID
            allowed_calcs_for_dma:
              - Lag
              - Range
              - Siblings

      - unique_name: Counterpart ID

      - unique_name: Counterpart Level
        is_hidden: true

level_attributes:

  - unique_name: By Counterpart Owner Level
    label: Owner ID
    dataset: VW_COUNTERPART_SCML.dataset
    key_columns:
      - COUNTERPART_OWNER_ID
    name_column: COUNTERPART_OWNER_ID
    allowed_calcs_for_dma:
      - Ancestor
      - Descendants
      - Lag
      - ParallelPeriod
      - Range
      - Siblings

  - unique_name: By Counterpart Type Level
    label: Counterpart Type
    dataset: VW_COUNTERPART_SCML.dataset
    key_columns:
      - COUNTERPART_TYPE
    name_column: COUNTERPART_TYPE
    allowed_calcs_for_dma:
      - Ancestor
      - Descendants
      - Lag
      - ParallelPeriod
      - Range
      - Siblings

  - unique_name: Counterpart ID
    label: Counterpart ID
    dataset: VW_COUNTERPART_SCML.dataset
    key_columns:
      - COUNTERPART_ID
    name_column: COUNTERPART_ID
    allowed_calcs_for_dma:
      - Ancestor
      - Descendants
      - Lag
      - ParallelPeriod
      - Range
      - Siblings

  - unique_name: Counterpart Level
    label: HKCompositeCounterpart
    dataset: VW_COUNTERPART_SCML.dataset
    key_columns:
      - HK_COMPOSITE_COUNTERPART
    name_column: HK_COMPOSITE_COUNTERPART

  - unique_name: Counterpart Sub Type
    label: Counterpart Sub Type
    dataset: VW_COUNTERPART_SCML.dataset
    key_columns:
      - COUNTERPART_SUB_TYPE
    name_column: COUNTERPART_SUB_TYPE
    allowed_calcs_for_dma:
      - Ancestor
      - Descendants
      - Lag
      - ParallelPeriod
      - Range
      - Siblings

relationships:

  - from:
      dataset: VW_COUNTERPART_SCML.dataset
      join_columns:
        - HK_CLIENT_SEGMENT_REPORTING_HIERARCHY
    to:
      dimension: Client Segment Reporting 1
      level: HK Client Segment Reporting Hierarchy
    type: embedded

modeler_metadata:
  version: "0"
  modified: "false"
